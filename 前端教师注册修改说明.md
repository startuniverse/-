# 前端教师注册功能修改说明

## 问题描述
原系统的注册界面只提供普通用户注册，没有教师注册选项。用户反馈在登录界面点击"立即注册"后，无法找到教师注册的入口。

## 解决方案
在前端添加专门的教师注册功能，包括：
1. 登录页面添加"教师注册"链接
2. 创建独立的教师注册页面
3. 添加学校选择功能
4. 支持教师特有信息录入（部门、职称等）

## 修改文件清单

### 1. 登录页面 - Login.vue
**文件路径**: `frontend/src/views/Login.vue`

**修改内容**:
```html
<!-- 原代码 -->
<div class="login-footer">
  <el-link type="primary" @click="$router.push('/register')">
    没有账户？立即注册
  </el-link>
</div>

<!-- 修改后 -->
<div class="login-footer">
  <div style="margin-bottom: 10px;">
    <el-link type="primary" @click="$router.push('/register')">
      没有账户？立即注册
    </el-link>
  </div>
  <div>
    <el-link type="success" @click="$router.push('/teacher-register')">
      教师注册
    </el-link>
  </div>
</div>
```

**效果**: 在登录页面底部添加"教师注册"链接，点击跳转到教师注册页面

### 2. 教师注册页面 - TeacherRegister.vue (新建)
**文件路径**: `frontend/src/views/TeacherRegister.vue`

**功能特性**:
- 用户名、密码、确认密码
- 真实姓名、手机号、邮箱
- 部门/院系、职称
- 学校选择（下拉列表，从后端获取）
- 表单验证
- 错误提示

**表单字段**:
| 字段 | 说明 | 是否必填 |
|------|------|----------|
| 用户名 | 登录账号 | 是 |
| 密码 | 登录密码 | 是 |
| 确认密码 | 确认密码 | 是 |
| 真实姓名 | 教师姓名 | 是 |
| 手机号 | 联系电话 | 是 |
| 邮箱 | 电子邮箱 | 否 |
| 部门/院系 | 所在部门 | 是 |
| 职称 | 教师职称 | 是 |
| 学校 | 所属学校 | 是 |

### 3. API接口 - auth.js
**文件路径**: `frontend/src/api/auth.js`

**新增方法**:
```javascript
/**
 * 教师注册
 */
export function registerTeacher(data) {
  return request({
    url: '/auth/register/teacher',
    method: 'post',
    data
  })
}
```

### 4. 路由配置 - index.js
**文件路径**: `frontend/src/router/index.js`

**新增路由**:
```javascript
{
  path: '/teacher-register',
  name: 'TeacherRegister',
  component: () => import('@/views/TeacherRegister.vue'),
  meta: { title: '教师注册' }
}
```

## 使用流程

### 教师注册流程
1. 访问登录页面 `/login`
2. 点击"教师注册"链接
3. 填写教师注册表单
4. 选择所属学校
5. 提交注册
6. 注册成功后跳转到登录页面
7. 使用教师账号登录

### 登录后角色判断
- **ADMIN**: 跳转到 `/admin/dashboard`
- **TEACHER**: 跳转到 `/` (校园门户)
- **USER**: 跳转到 `/` (校园门户)

## 后端接口依赖

教师注册页面需要以下后端接口支持：

### 1. 获取学校列表
```
GET /backend/school/list
```
**响应示例**:
```json
{
  "code": 200,
  "data": [
    {
      "id": 1,
      "schoolName": "第一中学",
      "schoolCode": "S001",
      "schoolType": "secondary"
    }
  ]
}
```

### 2. 教师注册
```
POST /auth/register/teacher
```
**请求参数**:
```json
{
  "username": "teacher01",
  "password": "123",
  "realName": "王老师",
  "phone": "13800138010",
  "email": "wang@edu.com",
  "schoolId": 1,
  "department": "数学教研组",
  "title": "高级教师"
}
```

## 页面样式

### 教师注册页面特点
- **标题**: "教师注册" / "创建教师账户"
- **按钮**: "注册教师账户" (绿色主题)
- **背景**: 渐变色背景 (与登录页面一致)
- **宽度**: 500px (比普通注册页面稍宽)
- **布局**: 垂直排列，表单字段分组清晰

### 颜色主题
- 主按钮: `type="primary"` (蓝色)
- 教师链接: `type="success"` (绿色)
- 普通链接: `type="default"` (灰色)

## 验证规则

| 字段 | 验证规则 | 错误提示 |
|------|----------|----------|
| 用户名 | 必填，最少3位 | "请输入用户名" / "用户名长度不能少于3位" |
| 密码 | 必填 | "请输入密码" |
| 确认密码 | 必填，必须等于密码 | "请再次输入密码" / "两次输入密码不一致!" |
| 真实姓名 | 必填 | "请输入真实姓名" |
| 手机号 | 必填，11位手机号格式 | "请输入手机号" / "请输入正确的手机号" |
| 部门 | 必填 | "请输入部门/院系" |
| 职称 | 必填 | "请输入职称" |
| 学校 | 必选 | "请选择学校" |

## 错误处理

### 前端验证错误
- 表单字段为空
- 密码不匹配
- 手机号格式错误
- 未选择学校

### 后端错误
- 用户名已存在
- 角色不存在
- 学校不存在
- 网络错误

### 错误提示
使用 Element Plus 的 `ElMessage` 组件显示：
```javascript
ElMessage.success('教师注册成功')
ElMessage.error('用户名已存在')
```

## 测试步骤

### 1. 启动后端服务
```bash
cd /e/shixun/backend
mvn spring-boot:run
```

### 2. 启动前端服务
```bash
cd /e/shixun/frontend
npm run dev
```

### 3. 执行数据库脚本
```sql
-- 确保TEACHER角色存在
INSERT IGNORE INTO role (role_code, role_name, description, deleted)
VALUES ('TEACHER', '教师', '教师用户角色', 0);

-- 确保有测试学校
INSERT IGNORE INTO school (school_code, school_name, school_type, address, contact_person, contact_phone, status, deleted)
VALUES ('S001', '第一中学', 'secondary', '北京市朝阳区', '张校长', '13800138001', 1, 0);
```

### 4. 测试流程
1. 访问 `http://localhost:5173/login`
2. 点击"教师注册"链接
3. 填写表单：
   - 用户名: teacher_test
   - 密码: 123
   - 确认密码: 123
   - 真实姓名: 测试老师
   - 手机号: 13800138099
   - 邮箱: test@edu.com
   - 部门: 语文教研组
   - 职称: 一级教师
   - 学校: 第一中学
4. 点击"注册教师账户"
5. 检查是否提示"教师注册成功"
6. 跳转到登录页面
7. 使用 teacher_test / 123 登录
8. 检查登录后角色是否为TEACHER

## 文件结构

```
frontend/
├── src/
│   ├── views/
│   │   ├── Login.vue              (修改)
│   │   ├── Register.vue           (未修改)
│   │   └── TeacherRegister.vue    (新建)
│   ├── api/
│   │   └── auth.js                (修改)
│   └── router/
│       └── index.js               (修改)
```

## 注意事项

1. **学校数据**: 确保数据库中有学校数据，否则下拉列表为空
2. **角色权限**: 教师注册后需要分配TEACHER角色
3. **密码加密**: 前端传输的密码会被后端自动加密
4. **跨域问题**: 确保后端CORS配置允许前端域名访问
5. **浏览器缓存**: 修改后建议清除浏览器缓存或强制刷新

## 与后端的配合

### 后端需要确保：
1. ✅ `POST /auth/register/teacher` 接口可用
2. ✅ `GET /backend/school/list` 接口可用（无需认证）
3. ✅ TEACHER角色已存在于数据库
4. ✅ 数据库中有学校数据

### 前端实现：
1. ✅ 登录页面添加教师注册链接
2. ✅ 独立的教师注册页面
3. ✅ 学校选择下拉框
4. ✅ 完整的表单验证
5. ✅ 错误处理和提示

## 效果预览

### 登录页面
```
城市教育局综合信息服务平台
请登录您的账户

[用户名输入框]
[密码输入框]
[登录按钮]

没有账户？立即注册
教师注册          <-- 新增链接
```

### 教师注册页面
```
教师注册
创建您的账户

用户名
密码
确认密码
真实姓名
手机号
邮箱（可选）
部门/院系
职称
学校（下拉选择）

[注册教师账户按钮]

已有账户？立即登录
普通用户注册
```

## 总结

通过以上修改，系统现在提供了完整的教师注册功能：
- 登录页面有明确的教师注册入口
- 独立的教师注册页面收集完整信息
- 支持学校选择
- 完整的表单验证
- 良好的用户体验

教师用户可以通过专门的入口注册，无需管理员手动添加，大大提升了系统的易用性。
