# 作业发布错误 - 快速修复指南

## 问题
教师发布作业时报错：`Unknown column 'created_at' in 'field list'`

## 根本原因
数据库 `assignment` 表字段名不一致：
- 其他表使用：`created_at`, `updated_at`
- assignment表使用：`create_time`, `update_time`

## 一键修复步骤

### 步骤1：停止后端服务
如果服务正在运行，请先停止

### 步骤2：执行数据库修复（最重要）
```bash
# 打开MySQL命令行或使用数据库管理工具
mysql -u root -p education_platform

# 或者直接执行修复脚本
mysql -u root -p education_platform < E:\shixun\fix_assignment_table.sql
```

**如果使用命令行，手动执行：**
```sql
USE education_platform;

ALTER TABLE assignment
CHANGE COLUMN create_time created_at DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间';

ALTER TABLE assignment
CHANGE COLUMN update_time updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间';
```

**验证修复：**
```sql
DESC assignment;
```
应该看到 `created_at` 和 `updated_at` 字段

### 步骤3：重新编译后端（可选但推荐）
```bash
cd E:\shixun\backend
mvn clean package -DskipTests
```

### 步骤4：重启后端服务
```bash
java -jar target/education-platform-0.0.1-SNAPSHOT.jar
```

### 步骤5：测试作业发布
1. 登录教师账号（123 / 123）
2. 进入作业管理
3. 发布新作业
4. 应该看到"发布成功"

## 快速验证

### 数据库验证
```sql
-- 查看assignment表结构
DESC assignment;

-- 查看现有数据
SELECT id, title, created_at, updated_at FROM assignment LIMIT 5;
```

### 功能验证
1. **教师发布作业** → 应该成功
2. **学生查看通知** → 应该能看到作业通知
3. **作业状态更新** → updated_at 应该自动更新

## 如果还有问题

### 检查1：数据库是否修改成功
```sql
SHOW CREATE TABLE assignment;
```
确认包含：
- `created_at` datetime DEFAULT CURRENT_TIMESTAMP
- `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP

### 检查2：重启服务
确保使用的是修改后的数据库连接

### 检查3：查看完整错误日志
查看后端控制台的完整错误信息

## 备用方案（不推荐）

如果无法修改数据库，可以修改Java代码：

**修改 Assignment.java：**
```java
@TableName("assignment")
public class Assignment extends BaseEntity {

    @TableField(value = "create_time")
    private LocalDateTime createdAt;

    @TableField(value = "update_time")
    private LocalDateTime updatedAt;

    // ... 其他字段
}
```

**但强烈建议使用数据库修改方案，保持一致性！**

## 完成确认

- [ ] 执行数据库修复脚本
- [ ] 验证表结构正确
- [ ] 重新编译后端（可选）
- [ ] 重启服务
- [ ] 测试作业发布功能
- [ ] 确认学生能看到作业通知

## 预计时间
- 数据库修复：1分钟
- 重新编译：2-3分钟
- 重启服务：30秒
- 测试：2分钟
- **总计：约6-7分钟**

---

**修复后，教师应该可以正常发布作业！**
